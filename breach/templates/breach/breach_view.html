{% extends 'dpotools.html' %}
{% load i18n %}

{% block title %}
  {% translate "My breach reports" %}
{% endblock %}

{% block content %}

  {% translate "Breach reports of originator" as reportsoforig %}
  {% translate "that are new or still available" as stillavail %}
  {% translate "No breach reports available." as noreports %}
  {% translate "Slug" as slug %}
  {% translate "View" as view %}
  {% translate "Export" as export %}
  {% translate "Edit" as edit %}
  {% translate "Delete" as delete %}

  <h4>
    {{ reportsoforig }}
    {% if request.user.get_full_name %}
      {{ request.user.get_full_name }},
    {% else %}
      {{ request.user }},
    {% endif %}
      {{ stillavail }}:
  </h4>

  <table id="reports-table" class="table table-striped table-bordered">
    <thead id="tableHeader">
      <tr>
        <th>{{ slug }}</th>
        <th>{{ view }}</th>
        <th>{{ export }}</th>
        <th>{{ edit }}</th>
        <th>{{ delete }}</th>
      </tr>
    </thead>
    <tbody id="tableBody">
    {% for breach in breach %}
      <tr>
        <td><code>{{ breach.slug }}</code></td>
        <td><a href="{% url 'breach:breach_detail' breach.slug %}" target="breach_detail">{{ view }} (HTML):&nbsp;{{ breach.slug }}</a></td>
        <td><a href="{% url 'breach:breach_detail_pdf' breach.slug %}" target="breach_detail_pdf">{{ export }} (PDF):&nbsp;{{ breach.slug}}</a></td>
        <td><a href="{% url 'breach:breach_detail_edit' breach.slug %}">{{ edit }}:&nbsp;{{ breach.slug}}</a></td>
        <td><a href="{% url 'breach:breach_detail_delete' breach.slug %}">{{ delete }}:&nbsp;{{ breach.slug}}</a></td>
      </tr>
    {% empty %}
      {{ noreports }}
    {% endfor %}
    </tbody>
  </table>

  <script>
    $(document).ready(function() {
      var rows = $('#tableBody tr').length;
      if ( rows == 0 ) {
        $('#tableHeader').hide();
      } else {
        $('#reports-table').DataTable({
          paging: true,
          ordering: true,
          searching: true,
          lengthChange: false,
          pageLength: 20,
          "columnDefs": [
            { "orderable": false, "targets": 1 },
            { "orderable": false, "targets": 2 },
            { "orderable": false, "targets": 3 }
          ]
        });
      }
    });
  </script>

  <p>&nbsp;</p>
  <p>
    <span class="dpotoolshint">
      {% blocktranslate %}
Choose "Edit" to complete newly created breach reports or edit still
available ones.
      {% endblocktranslate %}
    </span>
    <br>
    {% blocktranslate %}
Choose "New breach report" from the menue on the left to start a new
breach report.
    {% endblocktranslate %}
  </p>

{% endblock %}

